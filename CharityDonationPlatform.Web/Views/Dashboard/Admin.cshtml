@model AdminDashboardViewModel
@{
    ViewData["Title"] = "Admin Dashboard";
}

<div class="container-fluid py-4">
    <div class="row mb-4">
        <div class="col-12">
            <h1 class="display-5 fw-bold">Admin Dashboard</h1>
            <p class="lead text-muted">Platform overview and management</p>
        </div>
    </div>

    <!-- Stats Cards -->
    <div class="row mb-4">
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="card bg-success text-white h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h4>$@Model.TotalAmountRaised.ToString("N0")</h4>
                            <p class="mb-0">Total Raised</p>
                        </div>
                        <div class="align-self-center">
                            <i class="fas fa-dollar-sign fa-2x"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="card bg-primary text-white h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h4>@Model.TotalDonorsCount</h4>
                            <p class="mb-0">Total Donors</p>
                        </div>
                        <div class="align-self-center">
                            <i class="fas fa-users fa-2x"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="card bg-info text-white h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h4>@Model.ActiveCampaignsCount</h4>
                            <p class="mb-0">Active Campaigns</p>
                        </div>
                        <div class="align-self-center">
                            <i class="fas fa-bullhorn fa-2x"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="card bg-warning text-white h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h4>@Model.TotalCampaignsCount</h4>
                            <p class="mb-0">Total Campaigns</p>
                        </div>
                        <div class="align-self-center">
                            <i class="fas fa-chart-bar fa-2x"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Recent Campaigns -->
        <div class="col-lg-6 mb-4">
            <div class="card h-100">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0"><i class="fas fa-bullhorn me-2"></i>Recent Campaigns</h5>
                    <a asp-controller="Campaigns" asp-action="Create" class="btn btn-success btn-sm">
                        <i class="fas fa-plus me-2"></i>New Campaign
                    </a>
                </div>
                <div class="card-body">
                    @if (Model.RecentCampaigns.Any())
                    {
                        @foreach (var campaign in Model.RecentCampaigns)
                        {
                            <div class="d-flex align-items-center mb-3 pb-3 border-bottom">
                                <img src="@(string.IsNullOrEmpty(campaign.ImageUrl) ? "/images/default-campaign.jpg" : campaign.ImageUrl)"
                                     alt="@campaign.Title" class="rounded me-3" style="width: 60px; height: 60px; object-fit: cover;" />
                                <div class="flex-grow-1">
                                    <h6 class="mb-1">@campaign.Title</h6>
                                    <small class="text-muted">
                                        $@campaign.AmountRaised.ToString("N0") of $@campaign.TargetAmount.ToString("N0")
                                        (@campaign.ProgressPercentage.ToString("F1")%)
                                    </small>
                                    <div class="progress mt-1" style="height: 4px;">
                                        <div class="progress-bar" style="width: @campaign.ProgressPercentage%"></div>
                                    </div>
                                </div>
                                <div class="ms-3">
                                    <span class="badge bg-@(campaign.Status == "Active" ? "success" : "secondary")">
                                        @campaign.Status
                                    </span>
                                </div>
                            </div>
                        }
                        <div class="text-center">
                            <a asp-controller="Campaigns" asp-action="Index" class="btn btn-outline-primary btn-sm">
                                View All Campaigns
                            </a>
                        </div>
                    }
                    else
                    {
                        <p class="text-muted text-center">No campaigns found</p>
                    }
                </div>
            </div>
        </div>

        <!-- Recent Donations -->
        <div class="col-lg-6 mb-4">
            <div class="card h-100">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0"><i class="fas fa-heart me-2"></i>Recent Donations</h5>
                    <a asp-action="ExportDonations" class="btn btn-outline-secondary btn-sm">
                        <i class="fas fa-download me-2"></i>Export
                    </a>
                </div>
                <div class="card-body">
                    @if (Model.RecentDonations.Any())
                    {
                        @foreach (var donation in Model.RecentDonations)
                        {
                            <div class="d-flex justify-content-between align-items-center mb-3 pb-3 border-bottom">
                                <div>
                                    <h6 class="mb-1">@donation.DisplayDonorName</h6>
                                    <small class="text-muted">@donation.CampaignTitle</small>
                                </div>
                                <div class="text-end">
                                    <span class="fw-bold text-success">$@donation.Amount.ToString("N0")</span>
                                    <br><small class="text-muted">@donation.DonationDate.ToString("MMM dd")</small>
                                </div>
                            </div>
                        }
                    }
                    else
                    {
                        <p class="text-muted text-center">No donations found</p>
                    }
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Top Donors -->
        <div class="col-lg-6 mb-4">
            <div class="card h-100">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-trophy me-2"></i>Top Donors</h5>
                </div>
                <div class="card-body">
                    @if (Model.TopDonors.Any())
                    {
                        @foreach (var donor in Model.TopDonors)
                        {
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span>@donor.Key</span>
                                <span class="fw-bold text-success">$@donor.Value.ToString("N0")</span>
                            </div>
                        }
                    }
                    else
                    {
                        <p class="text-muted text-center">No donor data available</p>
                    }
                </div>
            </div>
        </div>

        <!-- Top Campaigns -->
        <div class="col-lg-6 mb-4">
            <div class="card h-100">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-chart-line me-2"></i>Top Campaigns by Amount</h5>
                </div>
                <div class="card-body">
                    @if (Model.TopCampaigns.Any())
                    {
                        @foreach (var campaign in Model.TopCampaigns)
                        {
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span class="text-truncate me-2">@campaign.Key</span>
                                <span class="fw-bold text-primary">$@campaign.Value.ToString("N0")</span>
                            </div>
                        }
                    }
                    else
                    {
                        <p class="text-muted text-center">No campaign data available</p>
                    }
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-bolt me-2"></i>Quick Actions</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-lg-3 col-md-6 mb-3">
                            <a asp-controller="Campaigns" asp-action="Create" class="btn btn-success w-100">
                                <i class="fas fa-plus fa-2x d-block mb-2"></i>
                                Create Campaign
                            </a>
                        </div>
                        <div class="col-lg-3 col-md-6 mb-3">
                            <a asp-controller="Campaigns" asp-action="Index" class="btn btn-primary w-100">
                                <i class="fas fa-list fa-2x d-block mb-2"></i>
                                Manage Campaigns
                            </a>
                        </div>
                        <div class="col-lg-3 col-md-6 mb-3">
                            <a asp-action="ExportDonations" class="btn btn-info w-100">
                                <i class="fas fa-download fa-2x d-block mb-2"></i>
                                Export Donations
                            </a>
                        </div>
                        <div class="col-lg-3 col-md-6 mb-3">
                            <a asp-action="ExportCampaigns" class="btn btn-warning w-100">
                                <i class="fas fa-file-export fa-2x d-block mb-2"></i>
                                Export Campaigns
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
